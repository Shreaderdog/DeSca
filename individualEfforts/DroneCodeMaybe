from time import sleep
import tellopy


def handler(event, sender, data, **args):
    drone = sender
    wind = 56;
    air_pressure = 30;
    rain = 0;
    if event is drone.EVENT_FLIGHT_DATA:
        print(data)
    if wind > 36:
        drone.down
    else:
        drone.takeoff
        if air_pressure > 30:
            drone.down
        else:
            drone.takeoff

            if rain == 1:
                drone.down
            else:
                drone.takeoff


def test():
    drone = tellopy.Tello()
    try:
        drone.subscribe(drone.EVENT_FLIGHT_DATA, handler)

        drone.connect()
        drone.wait_for_connection(60.0)
        drone.takeoff()
        sleep(5)
        drone.down(50)
        sleep(5)
        drone.land()
        sleep(5)
    except Exception as ex:
        print(ex)
    finally:
        drone.quit()

if __name__ == '__main__':
    test()
